#!/bin/sh

# set -o posix
# set -o pipefail
set -o errexit
set -o nounset

HOME=/home/fred

bk_cmd () {
  echo ">>> $1 --> $2:"
  rsync "-ahH" "--delete" "--progress" "--xattrs" "--acls" "--delete-excluded" '--exclude="*/target"' "$1" "$2"
  echo ">>> ------ <<<"
}

if [ "$(hostname)" = "floron" ]; then
  echo "Floron backup"

  DST="fred@axon:$HOME/Data/Fred"

  bk_cmd  "$HOME/.gnupg/"                 "$DST/Configs/Laptop/gnupg/"
  bk_cmd  "$HOME/.ssh/"                   "$DST/Configs/Laptop/ssh/"
  bk_cmd  "$HOME/.config/beets/"          "$DST/Configs/Laptop/config-beets/"
  bk_cmd  "$HOME/.config/hexchat/"        "$DST/Configs/Laptop/config-hexchat/"
  bk_cmd  "$HOME/.config/MusicBrainz/"    "$DST/Configs/Laptop/config-MusicBrainz/"
  bk_cmd  "$HOME/.config/transmission/"   "$DST/Configs/Laptop/config-transmission/"
  bk_cmd  "$HOME/.config/youtube-dl/"     "$DST/Configs/Laptop/config-youtube-dl/"
  bk_cmd  "$HOME/.local/share/keyrings"   "$DST/Configs/Laptop/local-share-keyrings/"

  bk_cmd  "$HOME/.thunderbird/"           "$DST/Configs/Laptop/thunderbird/"
  bk_cmd  "$HOME/.idealgraphvisualizer/"  "$DST/Configs/Laptop/idealgraphvisualizer/"
  bk_cmd  "$HOME/.eclipse/"               "$DST/Configs/Laptop/eclipse/"
  bk_cmd  "$HOME/.zoom/"                  "$DST/Configs/Laptop/zoom/"
  bk_cmd  "$HOME/.tree-sitter/"           "$DST/Configs/Laptop/tree-sitter/"

  bk_cmd  "$HOME/.face"                   "$DST/Configs/Laptop/face"
  bk_cmd  "$HOME/.wallpaper.jpg"          "$DST/Configs/Laptop/wallpaper.jpg"
  bk_cmd  "$HOME/.wallpaper_old.jpg"      "$DST/Configs/Laptop/wallpaper_old.jpg"

elif [ "$(hostname)" = "axon" ]; then
  echo "Axon backup"

  DST="$HOME/Data/Fred/"

  bk_cmd  "$HOME/Documents/"              "$DST/Documents/"
  bk_cmd  "$HOME/Downloads/"              "$DST/Downloads/"
  bk_cmd  "$HOME/Videos/"                 "$DST/Videos/"
  bk_cmd  "$HOME/VideosCS/"               "$DST/VideosCS/"

  # bk_cmd  "$HOME/Archive/"                "$DST/Archive/"
  # bk_cmd  "$HOME/Books/"                  "$DST/Books/"
  # bk_cmd  "$HOME/GMail/"                  "$DST/GMail/"
  # bk_cmd  "$HOME/Music/"                  "$DST/Music/"
  # bk_cmd  "$HOME/Music.New/"              "$DST/Music.New/"
  # bk_cmd  "$HOME/Workspace/"              "$DST/Workspace/"

else
  echo "Unknown host, not doing any backups"
fi
